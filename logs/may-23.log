|INFO| FAISS index and metadata found. Skipping build. Use --build to force rebuild.
|INFO| Initializing LLM re-ranker with model: qwen2.5:7b

|INFO| Processing transaction file: dataset/transaction/may-23.csv
|INFO| Running initial semantic matching for may-23
Transaction Queries:   0%|          | 0/96 [00:00<?, ?it/s]Transaction Queries:   1%|          | 1/96 [00:01<01:56,  1.23s/it]Transaction Queries:   2%|▏         | 2/96 [00:01<01:14,  1.26it/s]Transaction Queries:   3%|▎         | 3/96 [00:02<00:59,  1.57it/s]Transaction Queries:   4%|▍         | 4/96 [00:02<00:52,  1.75it/s]Transaction Queries:   5%|▌         | 5/96 [00:03<00:55,  1.63it/s]Transaction Queries:   6%|▋         | 6/96 [00:03<00:52,  1.73it/s]Transaction Queries:   7%|▋         | 7/96 [00:04<00:53,  1.68it/s]Transaction Queries:   8%|▊         | 8/96 [00:05<01:12,  1.22it/s]Transaction Queries:   9%|▉         | 9/96 [00:07<01:24,  1.03it/s]Transaction Queries:  10%|█         | 10/96 [00:08<01:30,  1.05s/it]Transaction Queries:  11%|█▏        | 11/96 [00:09<01:34,  1.12s/it]Transaction Queries:  12%|█▎        | 12/96 [00:10<01:34,  1.13s/it]Transaction Queries:  14%|█▎        | 13/96 [00:11<01:37,  1.17s/it]Transaction Queries:  15%|█▍        | 14/96 [00:13<01:37,  1.19s/it]Transaction Queries:  16%|█▌        | 15/96 [00:14<01:34,  1.17s/it]Transaction Queries:  17%|█▋        | 16/96 [00:15<01:35,  1.20s/it]Transaction Queries:  18%|█▊        | 17/96 [00:16<01:34,  1.20s/it]Transaction Queries:  19%|█▉        | 18/96 [00:18<01:34,  1.21s/it]Transaction Queries:  20%|█▉        | 19/96 [00:19<01:32,  1.20s/it]Transaction Queries:  21%|██        | 20/96 [00:20<01:28,  1.16s/it]Transaction Queries:  22%|██▏       | 21/96 [00:21<01:28,  1.17s/it]Transaction Queries:  23%|██▎       | 22/96 [00:22<01:25,  1.16s/it]Transaction Queries:  24%|██▍       | 23/96 [00:23<01:22,  1.13s/it]Transaction Queries:  25%|██▌       | 24/96 [00:24<01:21,  1.13s/it]Transaction Queries:  26%|██▌       | 25/96 [00:25<01:18,  1.11s/it]Transaction Queries:  27%|██▋       | 26/96 [00:27<01:20,  1.15s/it]Transaction Queries:  28%|██▊       | 27/96 [00:28<01:18,  1.14s/it]Transaction Queries:  29%|██▉       | 28/96 [00:29<01:14,  1.09s/it]Transaction Queries:  30%|███       | 29/96 [00:30<01:14,  1.11s/it]Transaction Queries:  31%|███▏      | 30/96 [00:31<01:13,  1.11s/it]Transaction Queries:  32%|███▏      | 31/96 [00:32<01:10,  1.08s/it]Transaction Queries:  33%|███▎      | 32/96 [00:33<01:07,  1.06s/it]Transaction Queries:  34%|███▍      | 33/96 [00:34<01:06,  1.05s/it]Transaction Queries:  35%|███▌      | 34/96 [00:35<01:03,  1.03s/it]Transaction Queries:  36%|███▋      | 35/96 [00:36<01:02,  1.02s/it]Transaction Queries:  38%|███▊      | 36/96 [00:37<01:01,  1.02s/it]Transaction Queries:  39%|███▊      | 37/96 [00:38<00:58,  1.01it/s]Transaction Queries:  40%|███▉      | 38/96 [00:39<00:57,  1.02it/s]Transaction Queries:  41%|████      | 39/96 [00:40<00:56,  1.00it/s]Transaction Queries:  42%|████▏     | 40/96 [00:41<00:54,  1.03it/s]Transaction Queries:  43%|████▎     | 41/96 [00:42<00:53,  1.03it/s]Transaction Queries:  44%|████▍     | 42/96 [00:43<00:52,  1.02it/s]Transaction Queries:  45%|████▍     | 43/96 [00:44<00:50,  1.05it/s]Transaction Queries:  46%|████▌     | 44/96 [00:45<00:49,  1.05it/s]Transaction Queries:  47%|████▋     | 45/96 [00:46<00:47,  1.07it/s]Transaction Queries:  48%|████▊     | 46/96 [00:46<00:45,  1.10it/s]Transaction Queries:  49%|████▉     | 47/96 [00:47<00:43,  1.12it/s]Transaction Queries:  50%|█████     | 48/96 [00:48<00:43,  1.10it/s]Transaction Queries:  51%|█████     | 49/96 [00:49<00:42,  1.10it/s]Transaction Queries:  52%|█████▏    | 50/96 [00:50<00:42,  1.09it/s]Transaction Queries:  53%|█████▎    | 51/96 [00:51<00:40,  1.12it/s]Transaction Queries:  54%|█████▍    | 52/96 [00:52<00:38,  1.13it/s]Transaction Queries:  55%|█████▌    | 53/96 [00:53<00:37,  1.15it/s]Transaction Queries:  56%|█████▋    | 54/96 [00:54<00:36,  1.14it/s]Transaction Queries:  57%|█████▋    | 55/96 [00:54<00:35,  1.15it/s]Transaction Queries:  58%|█████▊    | 56/96 [00:55<00:33,  1.20it/s]Transaction Queries:  59%|█████▉    | 57/96 [00:56<00:30,  1.30it/s]Transaction Queries:  60%|██████    | 58/96 [00:56<00:29,  1.30it/s]Transaction Queries:  61%|██████▏   | 59/96 [00:57<00:28,  1.28it/s]Transaction Queries:  62%|██████▎   | 60/96 [00:58<00:27,  1.31it/s]Transaction Queries:  64%|██████▎   | 61/96 [00:59<00:25,  1.35it/s]Transaction Queries:  65%|██████▍   | 62/96 [00:59<00:24,  1.37it/s]Transaction Queries:  66%|██████▌   | 63/96 [01:00<00:24,  1.34it/s]Transaction Queries:  67%|██████▋   | 64/96 [01:01<00:23,  1.34it/s]Transaction Queries:  68%|██████▊   | 65/96 [01:02<00:22,  1.35it/s]Transaction Queries:  69%|██████▉   | 66/96 [01:02<00:22,  1.33it/s]Transaction Queries:  70%|██████▉   | 67/96 [01:03<00:21,  1.33it/s]Transaction Queries:  71%|███████   | 68/96 [01:04<00:21,  1.32it/s]Transaction Queries:  72%|███████▏  | 69/96 [01:05<00:20,  1.35it/s]Transaction Queries:  73%|███████▎  | 70/96 [01:05<00:19,  1.35it/s]Transaction Queries:  74%|███████▍  | 71/96 [01:06<00:18,  1.33it/s]Transaction Queries:  75%|███████▌  | 72/96 [01:07<00:18,  1.30it/s]Transaction Queries:  76%|███████▌  | 73/96 [01:08<00:17,  1.35it/s]Transaction Queries:  77%|███████▋  | 74/96 [01:08<00:16,  1.31it/s]Transaction Queries:  78%|███████▊  | 75/96 [01:09<00:15,  1.31it/s]Transaction Queries:  79%|███████▉  | 76/96 [01:10<00:15,  1.32it/s]Transaction Queries:  80%|████████  | 77/96 [01:11<00:13,  1.39it/s]Transaction Queries:  81%|████████▏ | 78/96 [01:11<00:13,  1.35it/s]Transaction Queries:  82%|████████▏ | 79/96 [01:12<00:12,  1.34it/s]Transaction Queries:  83%|████████▎ | 80/96 [01:13<00:12,  1.33it/s]Transaction Queries:  84%|████████▍ | 81/96 [01:14<00:10,  1.38it/s]Transaction Queries:  85%|████████▌ | 82/96 [01:14<00:10,  1.37it/s]Transaction Queries:  86%|████████▋ | 83/96 [01:15<00:09,  1.37it/s]Transaction Queries:  88%|████████▊ | 84/96 [01:16<00:08,  1.41it/s]Transaction Queries:  89%|████████▊ | 85/96 [01:16<00:07,  1.46it/s]Transaction Queries:  90%|████████▉ | 86/96 [01:17<00:06,  1.44it/s]Transaction Queries:  91%|█████████ | 87/96 [01:18<00:06,  1.45it/s]Transaction Queries:  92%|█████████▏| 88/96 [01:18<00:05,  1.42it/s]Transaction Queries:  93%|█████████▎| 89/96 [01:19<00:04,  1.42it/s]Transaction Queries:  94%|█████████▍| 90/96 [01:20<00:04,  1.42it/s]Transaction Queries:  95%|█████████▍| 91/96 [01:21<00:03,  1.41it/s]Transaction Queries:  96%|█████████▌| 92/96 [01:21<00:02,  1.41it/s]Transaction Queries:  97%|█████████▋| 93/96 [01:22<00:02,  1.43it/s]Transaction Queries:  98%|█████████▊| 94/96 [01:23<00:01,  1.48it/s]Transaction Queries:  99%|█████████▉| 95/96 [01:23<00:00,  1.48it/s]Transaction Queries: 100%|██████████| 96/96 [01:24<00:00,  1.52it/s]Transaction Queries: 100%|██████████| 96/96 [01:24<00:00,  1.14it/s]
INFO:llm_reranker:Loading matches from ./temp/may-23_transaction_matches.csv
INFO:llm_reranker:Processing 288 match records...
INFO:llm_reranker:Grouping transactions by: ['t_ITEMCODE', 't_NEW_CODES', 't_STORECODE', 't_DATE']
|INFO| Saved transaction matches to ./temp/may-23_transaction_matches.csv
|INFO| Running LLM re-ranking for may-23
LLM Re-ranking:   0%|          | 0/96 [00:00<?, ?it/s]LLM Re-ranking:   1%|          | 1/96 [00:26<41:19, 26.10s/it]LLM Re-ranking:   2%|▏         | 2/96 [01:00<48:16, 30.81s/it]LLM Re-ranking:   3%|▎         | 3/96 [01:39<53:51, 34.75s/it]LLM Re-ranking:   4%|▍         | 4/96 [02:15<53:59, 35.21s/it]LLM Re-ranking:   5%|▌         | 5/96 [02:49<52:38, 34.71s/it]LLM Re-ranking:   6%|▋         | 6/96 [03:22<51:07, 34.09s/it]LLM Re-ranking:   7%|▋         | 7/96 [03:55<49:55, 33.66s/it]LLM Re-ranking:   8%|▊         | 8/96 [04:27<48:56, 33.37s/it]LLM Re-ranking:   9%|▉         | 9/96 [05:01<48:20, 33.34s/it]LLM Re-ranking:  10%|█         | 10/96 [05:33<47:33, 33.18s/it]LLM Re-ranking:  11%|█▏        | 11/96 [06:06<46:48, 33.04s/it]LLM Re-ranking:  12%|█▎        | 12/96 [06:38<45:54, 32.79s/it]LLM Re-ranking:  14%|█▎        | 13/96 [07:11<45:17, 32.75s/it]LLM Re-ranking:  15%|█▍        | 14/96 [07:43<44:32, 32.59s/it]LLM Re-ranking:  16%|█▌        | 15/96 [08:15<43:39, 32.34s/it]LLM Re-ranking:  17%|█▋        | 16/96 [08:47<42:48, 32.10s/it]LLM Re-ranking:  18%|█▊        | 17/96 [09:18<42:02, 31.93s/it]LLM Re-ranking:  19%|█▉        | 18/96 [09:50<41:22, 31.83s/it]LLM Re-ranking:  20%|█▉        | 19/96 [10:19<39:49, 31.03s/it]LLM Re-ranking:  21%|██        | 20/96 [10:50<39:33, 31.23s/it]LLM Re-ranking:  22%|██▏       | 21/96 [11:20<38:25, 30.74s/it]LLM Re-ranking:  23%|██▎       | 22/96 [11:52<38:12, 30.98s/it]LLM Re-ranking:  24%|██▍       | 23/96 [12:21<37:07, 30.52s/it]LLM Re-ranking:  25%|██▌       | 24/96 [12:50<36:08, 30.12s/it]LLM Re-ranking:  26%|██▌       | 25/96 [13:20<35:35, 30.08s/it]LLM Re-ranking:  27%|██▋       | 26/96 [13:50<34:54, 29.92s/it]LLM Re-ranking:  28%|██▊       | 27/96 [14:19<34:18, 29.84s/it]LLM Re-ranking:  29%|██▉       | 28/96 [14:47<33:06, 29.21s/it]LLM Re-ranking:  30%|███       | 29/96 [15:17<32:45, 29.33s/it]LLM Re-ranking:  31%|███▏      | 30/96 [15:44<31:43, 28.83s/it]LLM Re-ranking:  32%|███▏      | 31/96 [16:12<30:54, 28.53s/it]LLM Re-ranking:  33%|███▎      | 32/96 [16:40<30:02, 28.16s/it]LLM Re-ranking:  34%|███▍      | 33/96 [17:07<29:22, 27.97s/it]LLM Re-ranking:  35%|███▌      | 34/96 [17:35<28:59, 28.05s/it]LLM Re-ranking:  36%|███▋      | 35/96 [18:03<28:14, 27.78s/it]LLM Re-ranking:  38%|███▊      | 36/96 [18:29<27:25, 27.43s/it]LLM Re-ranking:  39%|███▊      | 37/96 [18:55<26:33, 27.01s/it]LLM Re-ranking:  40%|███▉      | 38/96 [19:21<25:53, 26.78s/it]LLM Re-ranking:  41%|████      | 39/96 [19:47<25:07, 26.45s/it]LLM Re-ranking:  42%|████▏     | 40/96 [20:13<24:39, 26.43s/it]LLM Re-ranking:  43%|████▎     | 41/96 [20:38<23:50, 26.01s/it]LLM Re-ranking:  44%|████▍     | 42/96 [21:03<23:05, 25.66s/it]LLM Re-ranking:  45%|████▍     | 43/96 [21:27<22:05, 25.02s/it]LLM Re-ranking:  46%|████▌     | 44/96 [21:51<21:30, 24.82s/it]LLM Re-ranking:  47%|████▋     | 45/96 [22:15<20:52, 24.55s/it]LLM Re-ranking:  48%|████▊     | 46/96 [22:39<20:21, 24.44s/it]LLM Re-ranking:  49%|████▉     | 47/96 [23:03<19:46, 24.21s/it]LLM Re-ranking:  50%|█████     | 48/96 [23:28<19:27, 24.33s/it]LLM Re-ranking:  51%|█████     | 49/96 [23:51<18:51, 24.07s/it]LLM Re-ranking:  52%|█████▏    | 50/96 [24:14<18:16, 23.84s/it]LLM Re-ranking:  53%|█████▎    | 51/96 [24:37<17:43, 23.63s/it]LLM Re-ranking:  54%|█████▍    | 52/96 [25:01<17:13, 23.49s/it]LLM Re-ranking:  55%|█████▌    | 53/96 [25:23<16:29, 23.00s/it]LLM Re-ranking:  56%|█████▋    | 54/96 [25:43<15:33, 22.24s/it]LLM Re-ranking:  57%|█████▋    | 55/96 [26:04<14:54, 21.82s/it]LLM Re-ranking:  58%|█████▊    | 56/96 [26:24<14:18, 21.46s/it]LLM Re-ranking:  59%|█████▉    | 57/96 [26:45<13:48, 21.23s/it]LLM Re-ranking:  60%|██████    | 58/96 [27:06<13:17, 20.99s/it]LLM Re-ranking:  61%|██████▏   | 59/96 [27:25<12:42, 20.60s/it]LLM Re-ranking:  62%|██████▎   | 60/96 [27:45<12:13, 20.37s/it]LLM Re-ranking:  64%|██████▎   | 61/96 [28:05<11:50, 20.31s/it]LLM Re-ranking:  65%|██████▍   | 62/96 [28:25<11:29, 20.28s/it]LLM Re-ranking:  66%|██████▌   | 63/96 [28:46<11:08, 20.25s/it]LLM Re-ranking:  67%|██████▋   | 64/96 [29:06<10:46, 20.20s/it]LLM Re-ranking:  68%|██████▊   | 65/96 [29:25<10:19, 19.99s/it]LLM Re-ranking:  69%|██████▉   | 66/96 [29:45<09:58, 19.95s/it]LLM Re-ranking:  70%|██████▉   | 67/96 [30:05<09:38, 19.96s/it]LLM Re-ranking:  71%|███████   | 68/96 [30:25<09:15, 19.85s/it]LLM Re-ranking:  72%|███████▏  | 69/96 [30:45<08:56, 19.87s/it]LLM Re-ranking:  73%|███████▎  | 70/96 [31:04<08:35, 19.84s/it]LLM Re-ranking:  74%|███████▍  | 71/96 [31:24<08:15, 19.82s/it]LLM Re-ranking:  75%|███████▌  | 72/96 [31:44<07:54, 19.77s/it]LLM Re-ranking:  76%|███████▌  | 73/96 [32:03<07:33, 19.73s/it]LLM Re-ranking:  77%|███████▋  | 74/96 [32:23<07:13, 19.70s/it]LLM Re-ranking:  78%|███████▊  | 75/96 [32:43<06:53, 19.68s/it]LLM Re-ranking:  79%|███████▉  | 76/96 [33:02<06:34, 19.71s/it]LLM Re-ranking:  80%|████████  | 77/96 [33:22<06:15, 19.78s/it]LLM Re-ranking:  81%|████████▏ | 78/96 [33:42<05:55, 19.75s/it]LLM Re-ranking:  82%|████████▏ | 79/96 [34:02<05:35, 19.72s/it]LLM Re-ranking:  83%|████████▎ | 80/96 [34:22<05:17, 19.83s/it]LLM Re-ranking:  84%|████████▍ | 81/96 [34:40<04:51, 19.45s/it]LLM Re-ranking:  85%|████████▌ | 82/96 [34:59<04:29, 19.28s/it]LLM Re-ranking:  86%|████████▋ | 83/96 [35:18<04:09, 19.20s/it]LLM Re-ranking:  88%|████████▊ | 84/96 [35:38<03:51, 19.26s/it]LLM Re-ranking:  89%|████████▊ | 85/96 [35:57<03:31, 19.19s/it]LLM Re-ranking:  90%|████████▉ | 86/96 [36:15<03:10, 19.04s/it]LLM Re-ranking:  91%|█████████ | 87/96 [36:34<02:50, 18.90s/it]LLM Re-ranking:  92%|█████████▏| 88/96 [36:52<02:30, 18.77s/it]LLM Re-ranking:  93%|█████████▎| 89/96 [37:11<02:11, 18.75s/it]LLM Re-ranking:  94%|█████████▍| 90/96 [37:30<01:52, 18.74s/it]LLM Re-ranking:  95%|█████████▍| 91/96 [37:49<01:33, 18.72s/it]LLM Re-ranking:  96%|█████████▌| 92/96 [38:07<01:14, 18.72s/it]LLM Re-ranking:  97%|█████████▋| 93/96 [38:25<00:55, 18.47s/it]LLM Re-ranking:  98%|█████████▊| 94/96 [38:43<00:36, 18.21s/it]LLM Re-ranking:  98%|█████████▊| 94/96 [38:43<00:49, 24.72s/it]
INFO:llm_reranker:Saved LLM re-ranked results to ./temp/may-23_llm_reranked.csv
INFO:llm_reranker:
==================================================
INFO:llm_reranker:LLM RE-RANKING SUMMARY
INFO:llm_reranker:==================================================
INFO:llm_reranker:Total transactions processed: 94
INFO:llm_reranker:Successfully re-ranked: 88 (93.6%)
INFO:llm_reranker:Rejected (no good match): 6 (6.4%)
INFO:llm_reranker:LLM query failures: 0 (0.0%)
INFO:llm_reranker:==================================================
|INFO| LLM re-ranking completed. Results saved to ./temp/may-23_llm_reranked.csv
|INFO| Completed processing may-23
