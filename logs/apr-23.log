|INFO| FAISS index and metadata found. Skipping build. Use --build to force rebuild.
|INFO| Initializing LLM re-ranker with model: qwen2.5:7b

|INFO| Processing transaction file: dataset/transaction/apr-23.csv
|INFO| Running initial semantic matching for apr-23
Transaction Queries:   0%|          | 0/82 [00:00<?, ?it/s]Transaction Queries:   1%|          | 1/82 [00:01<01:47,  1.33s/it]Transaction Queries:   2%|▏         | 2/82 [00:01<01:06,  1.21it/s]Transaction Queries:   4%|▎         | 3/82 [00:02<00:53,  1.49it/s]Transaction Queries:   5%|▍         | 4/82 [00:02<00:45,  1.71it/s]Transaction Queries:   6%|▌         | 5/82 [00:03<00:42,  1.82it/s]Transaction Queries:   7%|▋         | 6/82 [00:03<00:45,  1.68it/s]Transaction Queries:   9%|▊         | 7/82 [00:04<00:42,  1.77it/s]Transaction Queries:  10%|▉         | 8/82 [00:05<00:46,  1.60it/s]Transaction Queries:  11%|█         | 9/82 [00:06<01:01,  1.19it/s]Transaction Queries:  12%|█▏        | 10/82 [00:07<01:10,  1.03it/s]Transaction Queries:  13%|█▎        | 11/82 [00:08<01:14,  1.06s/it]Transaction Queries:  15%|█▍        | 12/82 [00:10<01:18,  1.12s/it]Transaction Queries:  16%|█▌        | 13/82 [00:11<01:18,  1.13s/it]Transaction Queries:  17%|█▋        | 14/82 [00:12<01:19,  1.18s/it]Transaction Queries:  18%|█▊        | 15/82 [00:13<01:19,  1.18s/it]Transaction Queries:  20%|█▉        | 16/82 [00:15<01:17,  1.18s/it]Transaction Queries:  21%|██        | 17/82 [00:16<01:18,  1.20s/it]Transaction Queries:  22%|██▏       | 18/82 [00:17<01:17,  1.20s/it]Transaction Queries:  23%|██▎       | 19/82 [00:18<01:16,  1.21s/it]Transaction Queries:  24%|██▍       | 20/82 [00:19<01:13,  1.19s/it]Transaction Queries:  26%|██▌       | 21/82 [00:20<01:10,  1.16s/it]Transaction Queries:  27%|██▋       | 22/82 [00:22<01:10,  1.17s/it]Transaction Queries:  28%|██▊       | 23/82 [00:23<01:07,  1.14s/it]Transaction Queries:  29%|██▉       | 24/82 [00:24<01:05,  1.13s/it]Transaction Queries:  30%|███       | 25/82 [00:25<01:04,  1.14s/it]Transaction Queries:  32%|███▏      | 26/82 [00:26<01:01,  1.10s/it]Transaction Queries:  33%|███▎      | 27/82 [00:27<01:03,  1.15s/it]Transaction Queries:  34%|███▍      | 28/82 [00:28<01:01,  1.14s/it]Transaction Queries:  35%|███▌      | 29/82 [00:29<00:58,  1.10s/it]Transaction Queries:  37%|███▋      | 30/82 [00:31<00:58,  1.12s/it]Transaction Queries:  38%|███▊      | 31/82 [00:32<00:56,  1.10s/it]Transaction Queries:  39%|███▉      | 32/82 [00:33<00:54,  1.08s/it]Transaction Queries:  40%|████      | 33/82 [00:34<00:52,  1.06s/it]Transaction Queries:  41%|████▏     | 34/82 [00:35<00:49,  1.04s/it]Transaction Queries:  43%|████▎     | 35/82 [00:36<00:48,  1.02s/it]Transaction Queries:  44%|████▍     | 36/82 [00:37<00:46,  1.02s/it]Transaction Queries:  45%|████▌     | 37/82 [00:38<00:45,  1.01s/it]Transaction Queries:  46%|████▋     | 38/82 [00:39<00:43,  1.01it/s]Transaction Queries:  48%|████▊     | 39/82 [00:40<00:42,  1.02it/s]Transaction Queries:  49%|████▉     | 40/82 [00:41<00:41,  1.00it/s]Transaction Queries:  50%|█████     | 41/82 [00:41<00:39,  1.04it/s]Transaction Queries:  51%|█████     | 42/82 [00:42<00:38,  1.04it/s]Transaction Queries:  52%|█████▏    | 43/82 [00:43<00:38,  1.02it/s]Transaction Queries:  54%|█████▎    | 44/82 [00:44<00:36,  1.05it/s]Transaction Queries:  55%|█████▍    | 45/82 [00:45<00:34,  1.07it/s]Transaction Queries:  56%|█████▌    | 46/82 [00:46<00:33,  1.08it/s]Transaction Queries:  57%|█████▋    | 47/82 [00:47<00:31,  1.12it/s]Transaction Queries:  59%|█████▊    | 48/82 [00:48<00:30,  1.12it/s]Transaction Queries:  60%|█████▉    | 49/82 [00:49<00:29,  1.10it/s]Transaction Queries:  61%|██████    | 50/82 [00:50<00:29,  1.10it/s]Transaction Queries:  62%|██████▏   | 51/82 [00:51<00:28,  1.09it/s]Transaction Queries:  63%|██████▎   | 52/82 [00:52<00:26,  1.12it/s]Transaction Queries:  65%|██████▍   | 53/82 [00:52<00:25,  1.14it/s]Transaction Queries:  66%|██████▌   | 54/82 [00:53<00:24,  1.15it/s]Transaction Queries:  67%|██████▋   | 55/82 [00:54<00:23,  1.14it/s]Transaction Queries:  68%|██████▊   | 56/82 [00:55<00:22,  1.15it/s]Transaction Queries:  70%|██████▉   | 57/82 [00:56<00:20,  1.22it/s]Transaction Queries:  71%|███████   | 58/82 [00:56<00:18,  1.30it/s]Transaction Queries:  72%|███████▏  | 59/82 [00:57<00:17,  1.30it/s]Transaction Queries:  73%|███████▎  | 60/82 [00:58<00:17,  1.28it/s]Transaction Queries:  74%|███████▍  | 61/82 [00:59<00:16,  1.31it/s]Transaction Queries:  76%|███████▌  | 62/82 [00:59<00:14,  1.35it/s]Transaction Queries:  77%|███████▋  | 63/82 [01:00<00:13,  1.36it/s]Transaction Queries:  78%|███████▊  | 64/82 [01:01<00:13,  1.34it/s]Transaction Queries:  79%|███████▉  | 65/82 [01:02<00:12,  1.35it/s]Transaction Queries:  80%|████████  | 66/82 [01:02<00:11,  1.35it/s]Transaction Queries:  82%|████████▏ | 67/82 [01:03<00:11,  1.33it/s]Transaction Queries:  83%|████████▎ | 68/82 [01:04<00:10,  1.33it/s]Transaction Queries:  84%|████████▍ | 69/82 [01:05<00:09,  1.33it/s]Transaction Queries:  85%|████████▌ | 70/82 [01:05<00:08,  1.35it/s]Transaction Queries:  87%|████████▋ | 71/82 [01:06<00:08,  1.35it/s]Transaction Queries:  88%|████████▊ | 72/82 [01:07<00:07,  1.32it/s]Transaction Queries:  89%|████████▉ | 73/82 [01:08<00:06,  1.30it/s]Transaction Queries:  90%|█████████ | 74/82 [01:08<00:05,  1.34it/s]Transaction Queries:  91%|█████████▏| 75/82 [01:09<00:05,  1.30it/s]Transaction Queries:  93%|█████████▎| 76/82 [01:10<00:04,  1.31it/s]Transaction Queries:  94%|█████████▍| 77/82 [01:11<00:03,  1.34it/s]Transaction Queries:  95%|█████████▌| 78/82 [01:11<00:02,  1.38it/s]Transaction Queries:  96%|█████████▋| 79/82 [01:12<00:02,  1.36it/s]Transaction Queries:  98%|█████████▊| 80/82 [01:13<00:01,  1.34it/s]Transaction Queries:  99%|█████████▉| 81/82 [01:14<00:00,  1.33it/s]Transaction Queries: 100%|██████████| 82/82 [01:14<00:00,  1.39it/s]Transaction Queries: 100%|██████████| 82/82 [01:14<00:00,  1.10it/s]
INFO:llm_reranker:Loading matches from ./temp/apr-23_transaction_matches.csv
INFO:llm_reranker:Processing 246 match records...
INFO:llm_reranker:Grouping transactions by: ['t_ITEMCODE', 't_NEW_CODES', 't_STORECODE', 't_DATE']
|INFO| Saved transaction matches to ./temp/apr-23_transaction_matches.csv
|INFO| Running LLM re-ranking for apr-23
LLM Re-ranking:   0%|          | 0/82 [00:00<?, ?it/s]LLM Re-ranking:   1%|          | 1/82 [00:23<32:16, 23.91s/it]LLM Re-ranking:   2%|▏         | 2/82 [00:54<37:21, 28.02s/it]LLM Re-ranking:   4%|▎         | 3/82 [01:31<42:01, 31.92s/it]LLM Re-ranking:   5%|▍         | 4/82 [02:08<44:25, 34.17s/it]LLM Re-ranking:   6%|▌         | 5/82 [02:44<44:14, 34.48s/it]LLM Re-ranking:   7%|▋         | 6/82 [03:16<42:57, 33.92s/it]LLM Re-ranking:   9%|▊         | 7/82 [03:49<42:02, 33.63s/it]LLM Re-ranking:  10%|▉         | 8/82 [04:22<41:06, 33.33s/it]LLM Re-ranking:  11%|█         | 9/82 [04:55<40:31, 33.31s/it]LLM Re-ranking:  12%|█▏        | 10/82 [05:28<39:49, 33.19s/it]LLM Re-ranking:  13%|█▎        | 11/82 [06:01<39:05, 33.03s/it]LLM Re-ranking:  15%|█▍        | 12/82 [06:34<38:29, 32.99s/it]LLM Re-ranking:  16%|█▌        | 13/82 [07:06<37:45, 32.83s/it]LLM Re-ranking:  17%|█▋        | 14/82 [07:38<36:56, 32.60s/it]LLM Re-ranking:  18%|█▊        | 15/82 [08:10<36:12, 32.43s/it]LLM Re-ranking:  20%|█▉        | 16/82 [08:42<35:22, 32.16s/it]LLM Re-ranking:  21%|██        | 17/82 [09:13<34:38, 31.98s/it]LLM Re-ranking:  22%|██▏       | 18/82 [09:45<33:57, 31.83s/it]LLM Re-ranking:  23%|██▎       | 19/82 [10:16<33:19, 31.73s/it]LLM Re-ranking:  24%|██▍       | 20/82 [10:46<32:04, 31.04s/it]LLM Re-ranking:  26%|██▌       | 21/82 [11:17<31:43, 31.20s/it]LLM Re-ranking:  27%|██▋       | 22/82 [11:47<30:43, 30.72s/it]LLM Re-ranking:  28%|██▊       | 23/82 [12:18<30:25, 30.93s/it]LLM Re-ranking:  29%|██▉       | 24/82 [12:48<29:25, 30.45s/it]LLM Re-ranking:  30%|███       | 25/82 [13:18<28:44, 30.25s/it]LLM Re-ranking:  32%|███▏      | 26/82 [13:47<28:01, 30.02s/it]LLM Re-ranking:  33%|███▎      | 27/82 [14:17<27:28, 29.97s/it]LLM Re-ranking:  34%|███▍      | 28/82 [14:44<26:17, 29.21s/it]LLM Re-ranking:  35%|███▌      | 29/82 [15:14<26:01, 29.46s/it]LLM Re-ranking:  37%|███▋      | 30/82 [15:42<25:01, 28.87s/it]LLM Re-ranking:  38%|███▊      | 31/82 [16:10<24:14, 28.53s/it]LLM Re-ranking:  39%|███▉      | 32/82 [16:37<23:31, 28.23s/it]LLM Re-ranking:  40%|████      | 33/82 [17:05<22:52, 28.02s/it]LLM Re-ranking:  41%|████▏     | 34/82 [17:32<22:19, 27.90s/it]LLM Re-ranking:  43%|████▎     | 35/82 [18:00<21:50, 27.88s/it]LLM Re-ranking:  44%|████▍     | 36/82 [18:27<21:05, 27.51s/it]LLM Re-ranking:  45%|████▌     | 37/82 [18:53<20:15, 27.01s/it]LLM Re-ranking:  46%|████▋     | 38/82 [19:19<19:39, 26.81s/it]LLM Re-ranking:  48%|████▊     | 39/82 [19:45<18:56, 26.42s/it]LLM Re-ranking:  49%|████▉     | 40/82 [20:11<18:33, 26.51s/it]LLM Re-ranking:  50%|█████     | 41/82 [20:37<17:56, 26.26s/it]LLM Re-ranking:  51%|█████     | 42/82 [21:02<17:13, 25.84s/it]LLM Re-ranking:  52%|█████▏    | 43/82 [21:26<16:30, 25.40s/it]LLM Re-ranking:  54%|█████▎    | 44/82 [21:50<15:42, 24.81s/it]LLM Re-ranking:  55%|█████▍    | 45/82 [22:14<15:13, 24.69s/it]LLM Re-ranking:  56%|█████▌    | 46/82 [22:38<14:39, 24.44s/it]LLM Re-ranking:  57%|█████▋    | 47/82 [23:02<14:13, 24.39s/it]LLM Re-ranking:  59%|█████▊    | 48/82 [23:26<13:42, 24.20s/it]LLM Re-ranking:  60%|█████▉    | 49/82 [23:50<13:20, 24.27s/it]LLM Re-ranking:  61%|██████    | 50/82 [24:13<12:45, 23.93s/it]LLM Re-ranking:  62%|██████▏   | 51/82 [24:36<12:13, 23.65s/it]LLM Re-ranking:  63%|██████▎   | 52/82 [24:59<11:43, 23.46s/it]LLM Re-ranking:  65%|██████▍   | 53/82 [25:21<11:05, 22.94s/it]LLM Re-ranking:  66%|██████▌   | 54/82 [25:42<10:23, 22.26s/it]LLM Re-ranking:  67%|██████▋   | 55/82 [26:03<09:49, 21.82s/it]LLM Re-ranking:  68%|██████▊   | 56/82 [26:23<09:18, 21.50s/it]LLM Re-ranking:  70%|██████▉   | 57/82 [26:44<08:49, 21.19s/it]LLM Re-ranking:  71%|███████   | 58/82 [27:04<08:24, 21.01s/it]LLM Re-ranking:  72%|███████▏  | 59/82 [27:25<07:59, 20.85s/it]LLM Re-ranking:  73%|███████▎  | 60/82 [27:45<07:31, 20.52s/it]LLM Re-ranking:  74%|███████▍  | 61/82 [28:05<07:08, 20.42s/it]LLM Re-ranking:  76%|███████▌  | 62/82 [28:25<06:46, 20.34s/it]LLM Re-ranking:  77%|███████▋  | 63/82 [28:45<06:26, 20.36s/it]LLM Re-ranking:  78%|███████▊  | 64/82 [29:06<06:05, 20.31s/it]LLM Re-ranking:  79%|███████▉  | 65/82 [29:25<05:41, 20.09s/it]LLM Re-ranking:  80%|████████  | 66/82 [29:45<05:19, 19.94s/it]LLM Re-ranking:  82%|████████▏ | 67/82 [30:05<04:59, 19.98s/it]LLM Re-ranking:  83%|████████▎ | 68/82 [30:25<04:38, 19.90s/it]LLM Re-ranking:  84%|████████▍ | 69/82 [30:44<04:18, 19.88s/it]LLM Re-ranking:  85%|████████▌ | 70/82 [31:04<03:57, 19.80s/it]LLM Re-ranking:  87%|████████▋ | 71/82 [31:24<03:37, 19.73s/it]LLM Re-ranking:  88%|████████▊ | 72/82 [31:44<03:18, 19.80s/it]LLM Re-ranking:  89%|████████▉ | 73/82 [32:03<02:57, 19.71s/it]LLM Re-ranking:  90%|█████████ | 74/82 [32:23<02:38, 19.75s/it]LLM Re-ranking:  91%|█████████▏| 75/82 [32:43<02:18, 19.73s/it]LLM Re-ranking:  93%|█████████▎| 76/82 [33:02<01:58, 19.74s/it]LLM Re-ranking:  94%|█████████▍| 77/82 [33:22<01:38, 19.75s/it]LLM Re-ranking:  95%|█████████▌| 78/82 [33:42<01:19, 19.77s/it]LLM Re-ranking:  96%|█████████▋| 79/82 [34:02<00:59, 19.72s/it]LLM Re-ranking:  98%|█████████▊| 80/82 [34:21<00:39, 19.77s/it]LLM Re-ranking:  98%|█████████▊| 80/82 [34:21<00:51, 25.77s/it]
INFO:llm_reranker:Saved LLM re-ranked results to ./temp/apr-23_llm_reranked.csv
INFO:llm_reranker:
==================================================
INFO:llm_reranker:LLM RE-RANKING SUMMARY
INFO:llm_reranker:==================================================
INFO:llm_reranker:Total transactions processed: 80
INFO:llm_reranker:Successfully re-ranked: 77 (96.2%)
INFO:llm_reranker:Rejected (no good match): 3 (3.8%)
INFO:llm_reranker:LLM query failures: 0 (0.0%)
INFO:llm_reranker:==================================================
|INFO| LLM re-ranking completed. Results saved to ./temp/apr-23_llm_reranked.csv
|INFO| Completed processing apr-23
