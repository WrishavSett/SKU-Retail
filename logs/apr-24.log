|INFO| FAISS index and metadata found. Skipping build. Use --build to force rebuild.
|INFO| Initializing LLM re-ranker with model: qwen2.5:7b

|INFO| Processing transaction file: dataset/transaction/apr-24.csv
|INFO| Running initial semantic matching for apr-24
Transaction Queries:   0%|          | 0/92 [00:00<?, ?it/s]Transaction Queries:   1%|          | 1/92 [00:01<01:45,  1.16s/it]Transaction Queries:   2%|▏         | 2/92 [00:01<01:08,  1.31it/s]Transaction Queries:   3%|▎         | 3/92 [00:02<00:55,  1.60it/s]Transaction Queries:   4%|▍         | 4/92 [00:02<00:49,  1.78it/s]Transaction Queries:   5%|▌         | 5/92 [00:03<00:47,  1.85it/s]Transaction Queries:   7%|▋         | 6/92 [00:03<00:50,  1.69it/s]Transaction Queries:   8%|▊         | 7/92 [00:04<00:48,  1.76it/s]Transaction Queries:   9%|▊         | 8/92 [00:05<01:02,  1.35it/s]Transaction Queries:  10%|▉         | 9/92 [00:06<01:16,  1.09it/s]Transaction Queries:  11%|█         | 10/92 [00:07<01:22,  1.01s/it]Transaction Queries:  12%|█▏        | 11/92 [00:09<01:28,  1.09s/it]Transaction Queries:  13%|█▎        | 12/92 [00:10<01:30,  1.13s/it]Transaction Queries:  14%|█▍        | 13/92 [00:11<01:31,  1.16s/it]Transaction Queries:  15%|█▌        | 14/92 [00:12<01:32,  1.19s/it]Transaction Queries:  16%|█▋        | 15/92 [00:14<01:29,  1.17s/it]Transaction Queries:  17%|█▋        | 16/92 [00:15<01:30,  1.19s/it]Transaction Queries:  18%|█▊        | 17/92 [00:16<01:31,  1.21s/it]Transaction Queries:  20%|█▉        | 18/92 [00:17<01:29,  1.21s/it]Transaction Queries:  21%|██        | 19/92 [00:18<01:28,  1.21s/it]Transaction Queries:  22%|██▏       | 20/92 [00:19<01:23,  1.16s/it]Transaction Queries:  23%|██▎       | 21/92 [00:21<01:22,  1.16s/it]Transaction Queries:  24%|██▍       | 22/92 [00:22<01:22,  1.17s/it]Transaction Queries:  25%|██▌       | 23/92 [00:23<01:17,  1.12s/it]Transaction Queries:  26%|██▌       | 24/92 [00:24<01:16,  1.13s/it]Transaction Queries:  27%|██▋       | 25/92 [00:25<01:15,  1.13s/it]Transaction Queries:  28%|██▊       | 26/92 [00:26<01:15,  1.14s/it]Transaction Queries:  29%|██▉       | 27/92 [00:27<01:14,  1.14s/it]Transaction Queries:  30%|███       | 28/92 [00:28<01:10,  1.10s/it]Transaction Queries:  32%|███▏      | 29/92 [00:30<01:09,  1.10s/it]Transaction Queries:  33%|███▎      | 30/92 [00:31<01:09,  1.12s/it]Transaction Queries:  34%|███▎      | 31/92 [00:32<01:05,  1.08s/it]Transaction Queries:  35%|███▍      | 32/92 [00:33<01:04,  1.07s/it]Transaction Queries:  36%|███▌      | 33/92 [00:34<01:02,  1.06s/it]Transaction Queries:  37%|███▋      | 34/92 [00:35<01:00,  1.03s/it]Transaction Queries:  38%|███▊      | 35/92 [00:36<00:58,  1.03s/it]Transaction Queries:  39%|███▉      | 36/92 [00:37<00:57,  1.03s/it]Transaction Queries:  40%|████      | 37/92 [00:38<00:53,  1.02it/s]Transaction Queries:  41%|████▏     | 38/92 [00:39<00:53,  1.01it/s]Transaction Queries:  42%|████▏     | 39/92 [00:40<00:52,  1.01it/s]Transaction Queries:  43%|████▎     | 40/92 [00:41<00:50,  1.03it/s]Transaction Queries:  45%|████▍     | 41/92 [00:42<00:49,  1.04it/s]Transaction Queries:  46%|████▌     | 42/92 [00:43<00:48,  1.03it/s]Transaction Queries:  47%|████▋     | 43/92 [00:43<00:46,  1.04it/s]Transaction Queries:  48%|████▊     | 44/92 [00:44<00:45,  1.06it/s]Transaction Queries:  49%|████▉     | 45/92 [00:45<00:43,  1.08it/s]Transaction Queries:  50%|█████     | 46/92 [00:46<00:42,  1.08it/s]Transaction Queries:  51%|█████     | 47/92 [00:47<00:40,  1.12it/s]Transaction Queries:  52%|█████▏    | 48/92 [00:48<00:39,  1.12it/s]Transaction Queries:  53%|█████▎    | 49/92 [00:49<00:39,  1.10it/s]Transaction Queries:  54%|█████▍    | 50/92 [00:50<00:38,  1.10it/s]Transaction Queries:  55%|█████▌    | 51/92 [00:51<00:36,  1.12it/s]Transaction Queries:  57%|█████▋    | 52/92 [00:52<00:35,  1.12it/s]Transaction Queries:  58%|█████▊    | 53/92 [00:52<00:33,  1.15it/s]Transaction Queries:  59%|█████▊    | 54/92 [00:53<00:33,  1.15it/s]Transaction Queries:  60%|█████▉    | 55/92 [00:54<00:32,  1.14it/s]Transaction Queries:  61%|██████    | 56/92 [00:55<00:30,  1.17it/s]Transaction Queries:  62%|██████▏   | 57/92 [00:56<00:27,  1.26it/s]Transaction Queries:  63%|██████▎   | 58/92 [00:56<00:26,  1.30it/s]Transaction Queries:  64%|██████▍   | 59/92 [00:57<00:25,  1.29it/s]Transaction Queries:  65%|██████▌   | 60/92 [00:58<00:24,  1.30it/s]Transaction Queries:  66%|██████▋   | 61/92 [00:58<00:22,  1.35it/s]Transaction Queries:  67%|██████▋   | 62/92 [00:59<00:22,  1.36it/s]Transaction Queries:  68%|██████▊   | 63/92 [01:00<00:21,  1.36it/s]Transaction Queries:  70%|██████▉   | 64/92 [01:01<00:20,  1.34it/s]Transaction Queries:  71%|███████   | 65/92 [01:01<00:19,  1.36it/s]Transaction Queries:  72%|███████▏  | 66/92 [01:02<00:19,  1.34it/s]Transaction Queries:  73%|███████▎  | 67/92 [01:03<00:18,  1.33it/s]Transaction Queries:  74%|███████▍  | 68/92 [01:04<00:18,  1.31it/s]Transaction Queries:  75%|███████▌  | 69/92 [01:04<00:17,  1.34it/s]Transaction Queries:  76%|███████▌  | 70/92 [01:05<00:16,  1.35it/s]Transaction Queries:  77%|███████▋  | 71/92 [01:06<00:15,  1.35it/s]Transaction Queries:  78%|███████▊  | 72/92 [01:07<00:15,  1.29it/s]Transaction Queries:  79%|███████▉  | 73/92 [01:07<00:14,  1.34it/s]Transaction Queries:  80%|████████  | 74/92 [01:08<00:13,  1.33it/s]Transaction Queries:  82%|████████▏ | 75/92 [01:09<00:12,  1.31it/s]Transaction Queries:  83%|████████▎ | 76/92 [01:10<00:12,  1.32it/s]Transaction Queries:  84%|████████▎ | 77/92 [01:10<00:11,  1.36it/s]Transaction Queries:  85%|████████▍ | 78/92 [01:11<00:10,  1.37it/s]Transaction Queries:  86%|████████▌ | 79/92 [01:12<00:09,  1.35it/s]Transaction Queries:  87%|████████▋ | 80/92 [01:13<00:09,  1.33it/s]Transaction Queries:  88%|████████▊ | 81/92 [01:13<00:08,  1.35it/s]Transaction Queries:  89%|████████▉ | 82/92 [01:14<00:07,  1.38it/s]Transaction Queries:  90%|█████████ | 83/92 [01:15<00:06,  1.39it/s]Transaction Queries:  91%|█████████▏| 84/92 [01:16<00:05,  1.39it/s]Transaction Queries:  92%|█████████▏| 85/92 [01:16<00:04,  1.44it/s]Transaction Queries:  93%|█████████▎| 86/92 [01:17<00:04,  1.45it/s]Transaction Queries:  95%|█████████▍| 87/92 [01:18<00:03,  1.46it/s]Transaction Queries:  96%|█████████▌| 88/92 [01:18<00:02,  1.43it/s]Transaction Queries:  97%|█████████▋| 89/92 [01:19<00:02,  1.43it/s]Transaction Queries:  98%|█████████▊| 90/92 [01:20<00:01,  1.43it/s]Transaction Queries:  99%|█████████▉| 91/92 [01:20<00:00,  1.44it/s]Transaction Queries: 100%|██████████| 92/92 [01:21<00:00,  1.41it/s]Transaction Queries: 100%|██████████| 92/92 [01:21<00:00,  1.13it/s]
INFO:llm_reranker:Loading matches from ./temp/apr-24_transaction_matches.csv
INFO:llm_reranker:Processing 276 match records...
INFO:llm_reranker:Grouping transactions by: ['t_ITEMCODE', 't_NEW_CODES', 't_STORECODE', 't_DATE']
|INFO| Saved transaction matches to ./temp/apr-24_transaction_matches.csv
|INFO| Running LLM re-ranking for apr-24
LLM Re-ranking:   0%|          | 0/92 [00:00<?, ?it/s]LLM Re-ranking:   1%|          | 1/92 [00:25<39:21, 25.95s/it]LLM Re-ranking:   2%|▏         | 2/92 [00:59<45:59, 30.66s/it]LLM Re-ranking:   3%|▎         | 3/92 [01:40<52:03, 35.09s/it]LLM Re-ranking:   4%|▍         | 4/92 [02:14<50:51, 34.68s/it]LLM Re-ranking:   5%|▌         | 5/92 [02:48<49:53, 34.41s/it]LLM Re-ranking:   7%|▋         | 6/92 [03:21<48:34, 33.89s/it]LLM Re-ranking:   8%|▊         | 7/92 [03:53<47:31, 33.54s/it]LLM Re-ranking:   9%|▊         | 8/92 [04:26<46:32, 33.24s/it]LLM Re-ranking:  10%|▉         | 9/92 [04:59<45:57, 33.23s/it]LLM Re-ranking:  11%|█         | 10/92 [05:32<45:13, 33.09s/it]LLM Re-ranking:  12%|█▏        | 11/92 [06:05<44:32, 33.00s/it]LLM Re-ranking:  13%|█▎        | 12/92 [06:38<44:05, 33.07s/it]LLM Re-ranking:  14%|█▍        | 13/92 [07:10<43:01, 32.68s/it]LLM Re-ranking:  15%|█▌        | 14/92 [07:44<43:00, 33.09s/it]LLM Re-ranking:  16%|█▋        | 15/92 [08:16<41:57, 32.69s/it]LLM Re-ranking:  17%|█▋        | 16/92 [08:47<40:56, 32.33s/it]LLM Re-ranking:  18%|█▊        | 17/92 [09:19<40:07, 32.10s/it]LLM Re-ranking:  20%|█▉        | 18/92 [09:49<38:45, 31.43s/it]LLM Re-ranking:  21%|██        | 19/92 [10:20<38:05, 31.30s/it]LLM Re-ranking:  22%|██▏       | 20/92 [10:49<37:01, 30.85s/it]LLM Re-ranking:  23%|██▎       | 21/92 [11:21<36:39, 30.99s/it]LLM Re-ranking:  24%|██▍       | 22/92 [11:50<35:42, 30.61s/it]LLM Re-ranking:  25%|██▌       | 23/92 [12:22<35:28, 30.84s/it]LLM Re-ranking:  26%|██▌       | 24/92 [12:51<34:23, 30.34s/it]LLM Re-ranking:  27%|██▋       | 25/92 [13:21<33:47, 30.26s/it]LLM Re-ranking:  28%|██▊       | 26/92 [13:51<33:01, 30.02s/it]LLM Re-ranking:  29%|██▉       | 27/92 [14:18<31:45, 29.32s/it]LLM Re-ranking:  30%|███       | 28/92 [14:48<31:23, 29.43s/it]LLM Re-ranking:  32%|███▏      | 29/92 [15:16<30:22, 28.92s/it]LLM Re-ranking:  33%|███▎      | 30/92 [15:45<30:08, 29.16s/it]LLM Re-ranking:  34%|███▎      | 31/92 [16:13<29:13, 28.75s/it]LLM Re-ranking:  35%|███▍      | 32/92 [16:40<28:19, 28.32s/it]LLM Re-ranking:  36%|███▌      | 33/92 [17:08<27:35, 28.06s/it]LLM Re-ranking:  37%|███▋      | 34/92 [17:35<26:58, 27.90s/it]LLM Re-ranking:  38%|███▊      | 35/92 [18:03<26:19, 27.71s/it]LLM Re-ranking:  39%|███▉      | 36/92 [18:29<25:20, 27.16s/it]LLM Re-ranking:  40%|████      | 37/92 [18:55<24:46, 27.03s/it]LLM Re-ranking:  41%|████▏     | 38/92 [19:21<23:55, 26.58s/it]LLM Re-ranking:  42%|████▏     | 39/92 [19:47<23:25, 26.51s/it]LLM Re-ranking:  43%|████▎     | 40/92 [20:13<22:46, 26.28s/it]LLM Re-ranking:  45%|████▍     | 41/92 [20:38<22:01, 25.90s/it]LLM Re-ranking:  46%|████▌     | 42/92 [21:03<21:19, 25.59s/it]LLM Re-ranking:  47%|████▋     | 43/92 [21:27<20:33, 25.17s/it]LLM Re-ranking:  48%|████▊     | 44/92 [21:51<19:46, 24.72s/it]LLM Re-ranking:  49%|████▉     | 45/92 [22:15<19:19, 24.67s/it]LLM Re-ranking:  50%|█████     | 46/92 [22:39<18:38, 24.32s/it]LLM Re-ranking:  51%|█████     | 47/92 [23:03<18:15, 24.35s/it]LLM Re-ranking:  52%|█████▏    | 48/92 [23:27<17:46, 24.24s/it]LLM Re-ranking:  53%|█████▎    | 49/92 [23:51<17:20, 24.19s/it]LLM Re-ranking:  54%|█████▍    | 50/92 [24:14<16:44, 23.92s/it]LLM Re-ranking:  55%|█████▌    | 51/92 [24:37<16:09, 23.64s/it]LLM Re-ranking:  57%|█████▋    | 52/92 [25:01<15:39, 23.49s/it]LLM Re-ranking:  58%|█████▊    | 53/92 [25:22<14:54, 22.93s/it]LLM Re-ranking:  59%|█████▊    | 54/92 [25:43<14:04, 22.23s/it]LLM Re-ranking:  60%|█████▉    | 55/92 [26:04<13:26, 21.79s/it]LLM Re-ranking:  61%|██████    | 56/92 [26:24<12:52, 21.47s/it]LLM Re-ranking:  62%|██████▏   | 57/92 [26:45<12:22, 21.22s/it]LLM Re-ranking:  63%|██████▎   | 58/92 [27:05<11:54, 21.01s/it]LLM Re-ranking:  64%|██████▍   | 59/92 [27:25<11:19, 20.60s/it]LLM Re-ranking:  65%|██████▌   | 60/92 [27:45<10:51, 20.36s/it]LLM Re-ranking:  66%|██████▋   | 61/92 [28:05<10:29, 20.31s/it]LLM Re-ranking:  67%|██████▋   | 62/92 [28:25<10:07, 20.26s/it]LLM Re-ranking:  68%|██████▊   | 63/92 [28:45<09:47, 20.26s/it]LLM Re-ranking:  70%|██████▉   | 64/92 [29:06<09:25, 20.21s/it]LLM Re-ranking:  71%|███████   | 65/92 [29:25<09:01, 20.04s/it]LLM Re-ranking:  72%|███████▏  | 66/92 [29:45<08:37, 19.91s/it]LLM Re-ranking:  73%|███████▎  | 67/92 [30:05<08:18, 19.94s/it]LLM Re-ranking:  74%|███████▍  | 68/92 [30:25<07:56, 19.86s/it]LLM Re-ranking:  75%|███████▌  | 69/92 [30:44<07:36, 19.87s/it]LLM Re-ranking:  76%|███████▌  | 70/92 [31:04<07:16, 19.84s/it]LLM Re-ranking:  77%|███████▋  | 71/92 [31:24<06:56, 19.84s/it]LLM Re-ranking:  78%|███████▊  | 72/92 [31:44<06:35, 19.76s/it]LLM Re-ranking:  79%|███████▉  | 73/92 [32:03<06:14, 19.71s/it]LLM Re-ranking:  80%|████████  | 74/92 [32:23<05:54, 19.70s/it]LLM Re-ranking:  82%|████████▏ | 75/92 [32:43<05:34, 19.70s/it]LLM Re-ranking:  83%|████████▎ | 76/92 [33:02<05:15, 19.69s/it]LLM Re-ranking:  84%|████████▎ | 77/92 [33:22<04:56, 19.80s/it]LLM Re-ranking:  85%|████████▍ | 78/92 [33:42<04:36, 19.77s/it]LLM Re-ranking:  86%|████████▌ | 79/92 [34:02<04:16, 19.73s/it]LLM Re-ranking:  87%|████████▋ | 80/92 [34:22<03:57, 19.81s/it]LLM Re-ranking:  88%|████████▊ | 81/92 [34:40<03:34, 19.46s/it]LLM Re-ranking:  89%|████████▉ | 82/92 [34:59<03:12, 19.25s/it]LLM Re-ranking:  90%|█████████ | 83/92 [35:18<02:52, 19.21s/it]LLM Re-ranking:  91%|█████████▏| 84/92 [35:37<02:33, 19.24s/it]LLM Re-ranking:  92%|█████████▏| 85/92 [35:57<02:14, 19.23s/it]LLM Re-ranking:  93%|█████████▎| 86/92 [36:15<01:54, 19.05s/it]LLM Re-ranking:  95%|█████████▍| 87/92 [36:34<01:34, 18.90s/it]LLM Re-ranking:  96%|█████████▌| 88/92 [36:52<01:15, 18.79s/it]LLM Re-ranking:  97%|█████████▋| 89/92 [37:11<00:56, 18.78s/it]LLM Re-ranking:  98%|█████████▊| 90/92 [37:30<00:37, 18.74s/it]LLM Re-ranking:  99%|█████████▉| 91/92 [37:48<00:18, 18.73s/it]LLM Re-ranking: 100%|██████████| 92/92 [38:07<00:00, 18.70s/it]LLM Re-ranking: 100%|██████████| 92/92 [38:07<00:00, 24.87s/it]
INFO:llm_reranker:Saved LLM re-ranked results to ./temp/apr-24_llm_reranked.csv
INFO:llm_reranker:
==================================================
INFO:llm_reranker:LLM RE-RANKING SUMMARY
INFO:llm_reranker:==================================================
INFO:llm_reranker:Total transactions processed: 92
INFO:llm_reranker:Successfully re-ranked: 90 (97.8%)
INFO:llm_reranker:Rejected (no good match): 2 (2.2%)
INFO:llm_reranker:LLM query failures: 0 (0.0%)
INFO:llm_reranker:==================================================
|INFO| LLM re-ranking completed. Results saved to ./temp/apr-24_llm_reranked.csv
|INFO| Completed processing apr-24
