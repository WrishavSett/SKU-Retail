|INFO| FAISS index and metadata found. Skipping build. Use --build to force rebuild.
|INFO| Initializing LLM re-ranker with model: qwen2.5:7b

|INFO| Processing transaction file: dataset/transaction/may-24.csv
|INFO| Running initial semantic matching for may-24
Transaction Queries:   0%|          | 0/97 [00:00<?, ?it/s]Transaction Queries:   1%|          | 1/97 [00:01<01:58,  1.24s/it]Transaction Queries:   2%|▏         | 2/97 [00:01<01:15,  1.27it/s]Transaction Queries:   3%|▎         | 3/97 [00:02<00:59,  1.57it/s]Transaction Queries:   4%|▍         | 4/97 [00:02<00:53,  1.75it/s]Transaction Queries:   5%|▌         | 5/97 [00:03<00:56,  1.63it/s]Transaction Queries:   6%|▌         | 6/97 [00:03<00:52,  1.73it/s]Transaction Queries:   7%|▋         | 7/97 [00:04<00:49,  1.81it/s]Transaction Queries:   8%|▊         | 8/97 [00:05<01:12,  1.23it/s]Transaction Queries:   9%|▉         | 9/97 [00:06<01:23,  1.05it/s]Transaction Queries:  10%|█         | 10/97 [00:08<01:30,  1.04s/it]Transaction Queries:  11%|█▏        | 11/97 [00:09<01:35,  1.11s/it]Transaction Queries:  12%|█▏        | 12/97 [00:10<01:36,  1.14s/it]Transaction Queries:  13%|█▎        | 13/97 [00:11<01:38,  1.17s/it]Transaction Queries:  14%|█▍        | 14/97 [00:13<01:37,  1.18s/it]Transaction Queries:  15%|█▌        | 15/97 [00:14<01:35,  1.16s/it]Transaction Queries:  16%|█▋        | 16/97 [00:15<01:36,  1.19s/it]Transaction Queries:  18%|█▊        | 17/97 [00:16<01:36,  1.21s/it]Transaction Queries:  19%|█▊        | 18/97 [00:17<01:35,  1.21s/it]Transaction Queries:  20%|█▉        | 19/97 [00:19<01:33,  1.20s/it]Transaction Queries:  21%|██        | 20/97 [00:20<01:29,  1.16s/it]Transaction Queries:  22%|██▏       | 21/97 [00:21<01:28,  1.17s/it]Transaction Queries:  23%|██▎       | 22/97 [00:22<01:27,  1.17s/it]Transaction Queries:  24%|██▎       | 23/97 [00:23<01:23,  1.13s/it]Transaction Queries:  25%|██▍       | 24/97 [00:24<01:22,  1.13s/it]Transaction Queries:  26%|██▌       | 25/97 [00:25<01:20,  1.12s/it]Transaction Queries:  27%|██▋       | 26/97 [00:27<01:22,  1.16s/it]Transaction Queries:  28%|██▊       | 27/97 [00:28<01:20,  1.14s/it]Transaction Queries:  29%|██▉       | 28/97 [00:29<01:15,  1.09s/it]Transaction Queries:  30%|██▉       | 29/97 [00:30<01:15,  1.11s/it]Transaction Queries:  31%|███       | 30/97 [00:31<01:14,  1.11s/it]Transaction Queries:  32%|███▏      | 31/97 [00:32<01:11,  1.08s/it]Transaction Queries:  33%|███▎      | 32/97 [00:33<01:08,  1.06s/it]Transaction Queries:  34%|███▍      | 33/97 [00:34<01:07,  1.06s/it]Transaction Queries:  35%|███▌      | 34/97 [00:35<01:04,  1.03s/it]Transaction Queries:  36%|███▌      | 35/97 [00:36<01:03,  1.02s/it]Transaction Queries:  37%|███▋      | 36/97 [00:37<01:02,  1.02s/it]Transaction Queries:  38%|███▊      | 37/97 [00:38<00:59,  1.02it/s]Transaction Queries:  39%|███▉      | 38/97 [00:39<00:58,  1.01it/s]Transaction Queries:  40%|████      | 39/97 [00:40<00:57,  1.01it/s]Transaction Queries:  41%|████      | 40/97 [00:41<00:54,  1.04it/s]Transaction Queries:  42%|████▏     | 41/97 [00:42<00:54,  1.03it/s]Transaction Queries:  43%|████▎     | 42/97 [00:43<00:53,  1.02it/s]Transaction Queries:  44%|████▍     | 43/97 [00:44<00:51,  1.05it/s]Transaction Queries:  45%|████▌     | 44/97 [00:45<00:50,  1.05it/s]Transaction Queries:  46%|████▋     | 45/97 [00:45<00:48,  1.07it/s]Transaction Queries:  47%|████▋     | 46/97 [00:46<00:46,  1.09it/s]Transaction Queries:  48%|████▊     | 47/97 [00:47<00:44,  1.12it/s]Transaction Queries:  49%|████▉     | 48/97 [00:48<00:44,  1.10it/s]Transaction Queries:  51%|█████     | 49/97 [00:49<00:43,  1.10it/s]Transaction Queries:  52%|█████▏    | 50/97 [00:50<00:42,  1.10it/s]Transaction Queries:  53%|█████▎    | 51/97 [00:51<00:41,  1.12it/s]Transaction Queries:  54%|█████▎    | 52/97 [00:52<00:39,  1.13it/s]Transaction Queries:  55%|█████▍    | 53/97 [00:52<00:37,  1.16it/s]Transaction Queries:  56%|█████▌    | 54/97 [00:53<00:37,  1.14it/s]Transaction Queries:  57%|█████▋    | 55/97 [00:54<00:36,  1.15it/s]Transaction Queries:  58%|█████▊    | 56/97 [00:55<00:34,  1.19it/s]Transaction Queries:  59%|█████▉    | 57/97 [00:56<00:30,  1.31it/s]Transaction Queries:  60%|█████▉    | 58/97 [00:56<00:29,  1.31it/s]Transaction Queries:  61%|██████    | 59/97 [00:57<00:29,  1.28it/s]Transaction Queries:  62%|██████▏   | 60/97 [00:58<00:28,  1.30it/s]Transaction Queries:  63%|██████▎   | 61/97 [00:59<00:26,  1.36it/s]Transaction Queries:  64%|██████▍   | 62/97 [00:59<00:25,  1.36it/s]Transaction Queries:  65%|██████▍   | 63/97 [01:00<00:25,  1.35it/s]Transaction Queries:  66%|██████▌   | 64/97 [01:01<00:24,  1.34it/s]Transaction Queries:  67%|██████▋   | 65/97 [01:02<00:23,  1.35it/s]Transaction Queries:  68%|██████▊   | 66/97 [01:02<00:23,  1.33it/s]Transaction Queries:  69%|██████▉   | 67/97 [01:03<00:22,  1.33it/s]Transaction Queries:  70%|███████   | 68/97 [01:04<00:21,  1.33it/s]Transaction Queries:  71%|███████   | 69/97 [01:05<00:20,  1.35it/s]Transaction Queries:  72%|███████▏  | 70/97 [01:05<00:20,  1.34it/s]Transaction Queries:  73%|███████▎  | 71/97 [01:06<00:19,  1.34it/s]Transaction Queries:  74%|███████▍  | 72/97 [01:07<00:19,  1.29it/s]Transaction Queries:  75%|███████▌  | 73/97 [01:08<00:17,  1.35it/s]Transaction Queries:  76%|███████▋  | 74/97 [01:08<00:17,  1.31it/s]Transaction Queries:  77%|███████▋  | 75/97 [01:09<00:16,  1.31it/s]Transaction Queries:  78%|███████▊  | 76/97 [01:10<00:15,  1.32it/s]Transaction Queries:  79%|███████▉  | 77/97 [01:11<00:14,  1.38it/s]Transaction Queries:  80%|████████  | 78/97 [01:11<00:13,  1.36it/s]Transaction Queries:  81%|████████▏ | 79/97 [01:12<00:13,  1.35it/s]Transaction Queries:  82%|████████▏ | 80/97 [01:13<00:12,  1.33it/s]Transaction Queries:  84%|████████▎ | 81/97 [01:14<00:11,  1.36it/s]Transaction Queries:  85%|████████▍ | 82/97 [01:14<00:10,  1.37it/s]Transaction Queries:  86%|████████▌ | 83/97 [01:15<00:10,  1.37it/s]Transaction Queries:  87%|████████▋ | 84/97 [01:16<00:09,  1.41it/s]Transaction Queries:  88%|████████▊ | 85/97 [01:16<00:08,  1.46it/s]Transaction Queries:  89%|████████▊ | 86/97 [01:17<00:07,  1.44it/s]Transaction Queries:  90%|████████▉ | 87/97 [01:18<00:06,  1.46it/s]Transaction Queries:  91%|█████████ | 88/97 [01:18<00:06,  1.43it/s]Transaction Queries:  92%|█████████▏| 89/97 [01:19<00:05,  1.42it/s]Transaction Queries:  93%|█████████▎| 90/97 [01:20<00:04,  1.43it/s]Transaction Queries:  94%|█████████▍| 91/97 [01:20<00:04,  1.42it/s]Transaction Queries:  95%|█████████▍| 92/97 [01:21<00:03,  1.41it/s]Transaction Queries:  96%|█████████▌| 93/97 [01:22<00:02,  1.43it/s]Transaction Queries:  97%|█████████▋| 94/97 [01:23<00:02,  1.48it/s]Transaction Queries:  98%|█████████▊| 95/97 [01:23<00:01,  1.48it/s]Transaction Queries:  99%|█████████▉| 96/97 [01:24<00:00,  1.51it/s]Transaction Queries: 100%|██████████| 97/97 [01:24<00:00,  1.52it/s]Transaction Queries: 100%|██████████| 97/97 [01:24<00:00,  1.14it/s]
INFO:llm_reranker:Loading matches from ./temp/may-24_transaction_matches.csv
INFO:llm_reranker:Processing 291 match records...
INFO:llm_reranker:Grouping transactions by: ['t_ITEMCODE', 't_NEW_CODES', 't_STORECODE', 't_DATE']
|INFO| Saved transaction matches to ./temp/may-24_transaction_matches.csv
|INFO| Running LLM re-ranking for may-24
LLM Re-ranking:   0%|          | 0/97 [00:00<?, ?it/s]LLM Re-ranking:   1%|          | 1/97 [00:28<45:34, 28.48s/it]LLM Re-ranking:   2%|▏         | 2/97 [01:02<50:28, 31.88s/it]LLM Re-ranking:   3%|▎         | 3/97 [01:41<54:45, 34.95s/it]LLM Re-ranking:   4%|▍         | 4/97 [02:17<54:40, 35.27s/it]LLM Re-ranking:   5%|▌         | 5/97 [02:50<53:16, 34.74s/it]LLM Re-ranking:   6%|▌         | 6/97 [03:23<51:43, 34.10s/it]LLM Re-ranking:   7%|▋         | 7/97 [03:56<50:29, 33.66s/it]LLM Re-ranking:   8%|▊         | 8/97 [04:29<49:33, 33.41s/it]LLM Re-ranking:   9%|▉         | 9/97 [05:02<48:53, 33.34s/it]LLM Re-ranking:  10%|█         | 10/97 [05:35<48:06, 33.18s/it]LLM Re-ranking:  11%|█▏        | 11/97 [06:08<47:20, 33.03s/it]LLM Re-ranking:  12%|█▏        | 12/97 [06:40<46:29, 32.82s/it]LLM Re-ranking:  13%|█▎        | 13/97 [07:12<45:50, 32.74s/it]LLM Re-ranking:  14%|█▍        | 14/97 [07:45<45:06, 32.60s/it]LLM Re-ranking:  15%|█▌        | 15/97 [08:17<44:12, 32.35s/it]LLM Re-ranking:  16%|█▋        | 16/97 [08:48<43:22, 32.13s/it]LLM Re-ranking:  18%|█▊        | 17/97 [09:20<42:37, 31.97s/it]LLM Re-ranking:  19%|█▊        | 18/97 [09:51<41:53, 31.82s/it]LLM Re-ranking:  20%|█▉        | 19/97 [10:20<40:19, 31.02s/it]LLM Re-ranking:  21%|██        | 20/97 [10:52<40:05, 31.24s/it]LLM Re-ranking:  22%|██▏       | 21/97 [11:22<38:55, 30.72s/it]LLM Re-ranking:  23%|██▎       | 22/97 [11:53<38:42, 30.96s/it]LLM Re-ranking:  24%|██▎       | 23/97 [12:23<37:37, 30.51s/it]LLM Re-ranking:  25%|██▍       | 24/97 [12:52<36:42, 30.17s/it]LLM Re-ranking:  26%|██▌       | 25/97 [13:22<36:02, 30.03s/it]LLM Re-ranking:  27%|██▋       | 26/97 [13:51<35:24, 29.93s/it]LLM Re-ranking:  28%|██▊       | 27/97 [14:21<34:49, 29.86s/it]LLM Re-ranking:  29%|██▉       | 28/97 [14:49<33:36, 29.22s/it]LLM Re-ranking:  30%|██▉       | 29/97 [15:18<33:14, 29.34s/it]LLM Re-ranking:  31%|███       | 30/97 [15:46<32:11, 28.82s/it]LLM Re-ranking:  32%|███▏      | 31/97 [16:14<31:23, 28.54s/it]LLM Re-ranking:  33%|███▎      | 32/97 [16:41<30:30, 28.16s/it]LLM Re-ranking:  34%|███▍      | 33/97 [17:09<29:51, 27.99s/it]LLM Re-ranking:  35%|███▌      | 34/97 [17:37<29:28, 28.08s/it]LLM Re-ranking:  36%|███▌      | 35/97 [18:04<28:42, 27.78s/it]LLM Re-ranking:  37%|███▋      | 36/97 [18:31<27:52, 27.42s/it]LLM Re-ranking:  38%|███▊      | 37/97 [18:57<26:58, 26.98s/it]LLM Re-ranking:  39%|███▉      | 38/97 [19:23<26:18, 26.75s/it]LLM Re-ranking:  40%|████      | 39/97 [19:49<25:37, 26.50s/it]LLM Re-ranking:  41%|████      | 40/97 [20:15<25:06, 26.44s/it]LLM Re-ranking:  42%|████▏     | 41/97 [20:40<24:15, 25.99s/it]LLM Re-ranking:  43%|████▎     | 42/97 [21:05<23:31, 25.67s/it]LLM Re-ranking:  44%|████▍     | 43/97 [21:29<22:31, 25.03s/it]LLM Re-ranking:  45%|████▌     | 44/97 [21:53<21:55, 24.82s/it]LLM Re-ranking:  46%|████▋     | 45/97 [22:17<21:17, 24.57s/it]LLM Re-ranking:  47%|████▋     | 46/97 [22:41<20:46, 24.43s/it]LLM Re-ranking:  48%|████▊     | 47/97 [23:05<20:11, 24.24s/it]LLM Re-ranking:  49%|████▉     | 48/97 [23:29<19:51, 24.31s/it]LLM Re-ranking:  51%|█████     | 49/97 [23:53<19:15, 24.08s/it]LLM Re-ranking:  52%|█████▏    | 50/97 [24:16<18:43, 23.91s/it]LLM Re-ranking:  53%|█████▎    | 51/97 [24:39<18:04, 23.59s/it]LLM Re-ranking:  54%|█████▎    | 52/97 [25:02<17:35, 23.46s/it]LLM Re-ranking:  55%|█████▍    | 53/97 [25:24<16:49, 22.94s/it]LLM Re-ranking:  56%|█████▌    | 54/97 [25:45<15:55, 22.22s/it]LLM Re-ranking:  57%|█████▋    | 55/97 [26:05<15:16, 21.82s/it]LLM Re-ranking:  58%|█████▊    | 56/97 [26:26<14:39, 21.44s/it]LLM Re-ranking:  59%|█████▉    | 57/97 [26:47<14:08, 21.20s/it]LLM Re-ranking:  60%|█████▉    | 58/97 [27:07<13:38, 20.99s/it]LLM Re-ranking:  61%|██████    | 59/97 [27:27<13:03, 20.63s/it]LLM Re-ranking:  62%|██████▏   | 60/97 [27:47<12:35, 20.43s/it]LLM Re-ranking:  63%|██████▎   | 61/97 [28:07<12:11, 20.31s/it]LLM Re-ranking:  64%|██████▍   | 62/97 [28:27<11:49, 20.28s/it]LLM Re-ranking:  65%|██████▍   | 63/97 [28:47<11:29, 20.28s/it]LLM Re-ranking:  66%|██████▌   | 64/97 [29:07<11:05, 20.17s/it]LLM Re-ranking:  67%|██████▋   | 65/97 [29:27<10:39, 19.99s/it]LLM Re-ranking:  68%|██████▊   | 66/97 [29:47<10:18, 19.96s/it]LLM Re-ranking:  69%|██████▉   | 67/97 [30:07<09:58, 19.94s/it]LLM Re-ranking:  70%|███████   | 68/97 [30:26<09:35, 19.85s/it]LLM Re-ranking:  71%|███████   | 69/97 [30:46<09:15, 19.84s/it]LLM Re-ranking:  72%|███████▏  | 70/97 [31:06<08:54, 19.81s/it]LLM Re-ranking:  73%|███████▎  | 71/97 [31:26<08:35, 19.82s/it]LLM Re-ranking:  74%|███████▍  | 72/97 [31:45<08:14, 19.76s/it]LLM Re-ranking:  75%|███████▌  | 73/97 [32:05<07:54, 19.75s/it]LLM Re-ranking:  76%|███████▋  | 74/97 [32:25<07:33, 19.71s/it]LLM Re-ranking:  77%|███████▋  | 75/97 [32:44<07:12, 19.67s/it]LLM Re-ranking:  78%|███████▊  | 76/97 [33:04<06:54, 19.72s/it]LLM Re-ranking:  79%|███████▉  | 77/97 [33:24<06:35, 19.79s/it]LLM Re-ranking:  80%|████████  | 78/97 [33:44<06:15, 19.74s/it]LLM Re-ranking:  81%|████████▏ | 79/97 [34:03<05:54, 19.71s/it]LLM Re-ranking:  82%|████████▏ | 80/97 [34:23<05:37, 19.84s/it]LLM Re-ranking:  84%|████████▎ | 81/97 [34:42<05:11, 19.46s/it]LLM Re-ranking:  85%|████████▍ | 82/97 [35:01<04:49, 19.31s/it]LLM Re-ranking:  86%|████████▌ | 83/97 [35:20<04:29, 19.22s/it]LLM Re-ranking:  87%|████████▋ | 84/97 [35:39<04:10, 19.27s/it]LLM Re-ranking:  88%|████████▊ | 85/97 [35:58<03:50, 19.18s/it]LLM Re-ranking:  89%|████████▊ | 86/97 [36:17<03:29, 19.01s/it]LLM Re-ranking:  90%|████████▉ | 87/97 [36:36<03:08, 18.90s/it]LLM Re-ranking:  91%|█████████ | 88/97 [36:54<02:48, 18.76s/it]LLM Re-ranking:  92%|█████████▏| 89/97 [37:13<02:29, 18.74s/it]LLM Re-ranking:  93%|█████████▎| 90/97 [37:31<02:11, 18.72s/it]LLM Re-ranking:  94%|█████████▍| 91/97 [37:50<01:52, 18.71s/it]LLM Re-ranking:  95%|█████████▍| 92/97 [38:09<01:33, 18.74s/it]LLM Re-ranking:  96%|█████████▌| 93/97 [38:27<01:14, 18.51s/it]LLM Re-ranking:  97%|█████████▋| 94/97 [38:44<00:54, 18.17s/it]LLM Re-ranking:  98%|█████████▊| 95/97 [39:01<00:35, 17.68s/it]LLM Re-ranking:  98%|█████████▊| 95/97 [39:01<00:49, 24.64s/it]
INFO:llm_reranker:Saved LLM re-ranked results to ./temp/may-24_llm_reranked.csv
INFO:llm_reranker:
==================================================
INFO:llm_reranker:LLM RE-RANKING SUMMARY
INFO:llm_reranker:==================================================
INFO:llm_reranker:Total transactions processed: 95
INFO:llm_reranker:Successfully re-ranked: 93 (97.9%)
INFO:llm_reranker:Rejected (no good match): 2 (2.1%)
INFO:llm_reranker:LLM query failures: 0 (0.0%)
INFO:llm_reranker:==================================================
|INFO| LLM re-ranking completed. Results saved to ./temp/may-24_llm_reranked.csv
|INFO| Completed processing may-24
