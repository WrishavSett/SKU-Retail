|INFO| FAISS index and metadata found. Skipping build. Use --build to force rebuild.
|INFO| Initializing LLM re-ranker with model: qwen2.5:7b

|INFO| Processing transaction file: dataset/transaction/jul-22.csv
|INFO| Running initial semantic matching for jul-22
Transaction Queries:   0%|          | 0/105 [00:00<?, ?it/s]Transaction Queries:   1%|          | 1/105 [00:01<02:02,  1.18s/it]Transaction Queries:   2%|▏         | 2/105 [00:01<01:19,  1.30it/s]Transaction Queries:   3%|▎         | 3/105 [00:02<01:04,  1.59it/s]Transaction Queries:   4%|▍         | 4/105 [00:02<00:56,  1.78it/s]Transaction Queries:   5%|▍         | 5/105 [00:03<00:53,  1.87it/s]Transaction Queries:   6%|▌         | 6/105 [00:03<00:58,  1.71it/s]Transaction Queries:   7%|▋         | 7/105 [00:04<00:55,  1.78it/s]Transaction Queries:   8%|▊         | 8/105 [00:05<01:05,  1.47it/s]Transaction Queries:   9%|▊         | 9/105 [00:06<01:23,  1.15it/s]Transaction Queries:  10%|▉         | 10/105 [00:07<01:33,  1.01it/s]Transaction Queries:  10%|█         | 11/105 [00:09<01:40,  1.07s/it]Transaction Queries:  11%|█▏        | 12/105 [00:10<01:45,  1.14s/it]Transaction Queries:  12%|█▏        | 13/105 [00:11<01:45,  1.15s/it]Transaction Queries:  13%|█▎        | 14/105 [00:12<01:47,  1.18s/it]Transaction Queries:  14%|█▍        | 15/105 [00:13<01:45,  1.17s/it]Transaction Queries:  15%|█▌        | 16/105 [00:15<01:44,  1.17s/it]Transaction Queries:  16%|█▌        | 17/105 [00:16<01:46,  1.21s/it]Transaction Queries:  17%|█▋        | 18/105 [00:17<01:45,  1.21s/it]Transaction Queries:  18%|█▊        | 19/105 [00:18<01:44,  1.21s/it]Transaction Queries:  19%|█▉        | 20/105 [00:19<01:40,  1.18s/it]Transaction Queries:  20%|██        | 21/105 [00:20<01:37,  1.16s/it]Transaction Queries:  21%|██        | 22/105 [00:22<01:37,  1.17s/it]Transaction Queries:  22%|██▏       | 23/105 [00:23<01:31,  1.12s/it]Transaction Queries:  23%|██▎       | 24/105 [00:24<01:31,  1.13s/it]Transaction Queries:  24%|██▍       | 25/105 [00:25<01:30,  1.13s/it]Transaction Queries:  25%|██▍       | 26/105 [00:26<01:27,  1.11s/it]Transaction Queries:  26%|██▌       | 27/105 [00:27<01:30,  1.15s/it]Transaction Queries:  27%|██▋       | 28/105 [00:28<01:27,  1.13s/it]Transaction Queries:  28%|██▊       | 29/105 [00:29<01:23,  1.10s/it]Transaction Queries:  29%|██▊       | 30/105 [00:31<01:24,  1.12s/it]Transaction Queries:  30%|██▉       | 31/105 [00:32<01:21,  1.10s/it]Transaction Queries:  30%|███       | 32/105 [00:33<01:19,  1.08s/it]Transaction Queries:  31%|███▏      | 33/105 [00:34<01:16,  1.06s/it]Transaction Queries:  32%|███▏      | 34/105 [00:35<01:12,  1.03s/it]Transaction Queries:  33%|███▎      | 35/105 [00:36<01:11,  1.02s/it]Transaction Queries:  34%|███▍      | 36/105 [00:37<01:10,  1.02s/it]Transaction Queries:  35%|███▌      | 37/105 [00:38<01:08,  1.00s/it]Transaction Queries:  36%|███▌      | 38/105 [00:39<01:06,  1.01it/s]Transaction Queries:  37%|███▋      | 39/105 [00:40<01:04,  1.02it/s]Transaction Queries:  38%|███▊      | 40/105 [00:41<01:03,  1.02it/s]Transaction Queries:  39%|███▉      | 41/105 [00:41<01:01,  1.04it/s]Transaction Queries:  40%|████      | 42/105 [00:42<01:00,  1.03it/s]Transaction Queries:  41%|████      | 43/105 [00:43<01:00,  1.03it/s]Transaction Queries:  42%|████▏     | 44/105 [00:44<00:58,  1.05it/s]Transaction Queries:  43%|████▎     | 45/105 [00:45<00:55,  1.07it/s]Transaction Queries:  44%|████▍     | 46/105 [00:46<00:54,  1.08it/s]Transaction Queries:  45%|████▍     | 47/105 [00:47<00:51,  1.12it/s]Transaction Queries:  46%|████▌     | 48/105 [00:48<00:51,  1.12it/s]Transaction Queries:  47%|████▋     | 49/105 [00:49<00:51,  1.09it/s]Transaction Queries:  48%|████▊     | 50/105 [00:50<00:49,  1.10it/s]Transaction Queries:  49%|████▊     | 51/105 [00:51<00:49,  1.09it/s]Transaction Queries:  50%|████▉     | 52/105 [00:51<00:47,  1.11it/s]Transaction Queries:  50%|█████     | 53/105 [00:52<00:45,  1.14it/s]Transaction Queries:  51%|█████▏    | 54/105 [00:53<00:44,  1.15it/s]Transaction Queries:  52%|█████▏    | 55/105 [00:54<00:43,  1.14it/s]Transaction Queries:  53%|█████▎    | 56/105 [00:55<00:42,  1.16it/s]Transaction Queries:  54%|█████▍    | 57/105 [00:56<00:38,  1.24it/s]Transaction Queries:  55%|█████▌    | 58/105 [00:56<00:35,  1.31it/s]Transaction Queries:  56%|█████▌    | 59/105 [00:57<00:35,  1.30it/s]Transaction Queries:  57%|█████▋    | 60/105 [00:58<00:35,  1.28it/s]Transaction Queries:  58%|█████▊    | 61/105 [00:59<00:33,  1.31it/s]Transaction Queries:  59%|█████▉    | 62/105 [00:59<00:31,  1.35it/s]Transaction Queries:  60%|██████    | 63/105 [01:00<00:30,  1.36it/s]Transaction Queries:  61%|██████    | 64/105 [01:01<00:30,  1.34it/s]Transaction Queries:  62%|██████▏   | 65/105 [01:01<00:29,  1.35it/s]Transaction Queries:  63%|██████▎   | 66/105 [01:02<00:28,  1.35it/s]Transaction Queries:  64%|██████▍   | 67/105 [01:03<00:28,  1.33it/s]Transaction Queries:  65%|██████▍   | 68/105 [01:04<00:28,  1.32it/s]Transaction Queries:  66%|██████▌   | 69/105 [01:04<00:27,  1.33it/s]Transaction Queries:  67%|██████▋   | 70/105 [01:05<00:25,  1.35it/s]Transaction Queries:  68%|██████▊   | 71/105 [01:06<00:25,  1.36it/s]Transaction Queries:  69%|██████▊   | 72/105 [01:07<00:25,  1.29it/s]Transaction Queries:  70%|██████▉   | 73/105 [01:07<00:24,  1.33it/s]Transaction Queries:  70%|███████   | 74/105 [01:08<00:23,  1.33it/s]Transaction Queries:  71%|███████▏  | 75/105 [01:09<00:22,  1.31it/s]Transaction Queries:  72%|███████▏  | 76/105 [01:10<00:22,  1.31it/s]Transaction Queries:  73%|███████▎  | 77/105 [01:10<00:20,  1.36it/s]Transaction Queries:  74%|███████▍  | 78/105 [01:11<00:19,  1.38it/s]Transaction Queries:  75%|███████▌  | 79/105 [01:12<00:19,  1.35it/s]Transaction Queries:  76%|███████▌  | 80/105 [01:13<00:18,  1.33it/s]Transaction Queries:  77%|███████▋  | 81/105 [01:13<00:17,  1.34it/s]Transaction Queries:  78%|███████▊  | 82/105 [01:14<00:16,  1.38it/s]Transaction Queries:  79%|███████▉  | 83/105 [01:15<00:15,  1.39it/s]Transaction Queries:  80%|████████  | 84/105 [01:16<00:15,  1.40it/s]Transaction Queries:  81%|████████  | 85/105 [01:16<00:13,  1.44it/s]Transaction Queries:  82%|████████▏ | 86/105 [01:17<00:13,  1.46it/s]Transaction Queries:  83%|████████▎ | 87/105 [01:18<00:12,  1.45it/s]Transaction Queries:  84%|████████▍ | 88/105 [01:18<00:11,  1.45it/s]Transaction Queries:  85%|████████▍ | 89/105 [01:19<00:11,  1.43it/s]Transaction Queries:  86%|████████▌ | 90/105 [01:20<00:10,  1.42it/s]Transaction Queries:  87%|████████▋ | 91/105 [01:20<00:09,  1.43it/s]Transaction Queries:  88%|████████▊ | 92/105 [01:21<00:09,  1.42it/s]Transaction Queries:  89%|████████▊ | 93/105 [01:22<00:08,  1.40it/s]Transaction Queries:  90%|████████▉ | 94/105 [01:22<00:07,  1.43it/s]Transaction Queries:  90%|█████████ | 95/105 [01:23<00:06,  1.48it/s]Transaction Queries:  91%|█████████▏| 96/105 [01:24<00:06,  1.48it/s]Transaction Queries:  92%|█████████▏| 97/105 [01:24<00:05,  1.52it/s]Transaction Queries:  93%|█████████▎| 98/105 [01:25<00:04,  1.56it/s]Transaction Queries:  94%|█████████▍| 99/105 [01:25<00:03,  1.67it/s]Transaction Queries:  95%|█████████▌| 100/105 [01:26<00:02,  1.74it/s]Transaction Queries:  96%|█████████▌| 101/105 [01:27<00:02,  1.72it/s]Transaction Queries:  97%|█████████▋| 102/105 [01:27<00:01,  1.73it/s]Transaction Queries:  98%|█████████▊| 103/105 [01:28<00:01,  1.70it/s]Transaction Queries:  99%|█████████▉| 104/105 [01:28<00:00,  1.69it/s]Transaction Queries: 100%|██████████| 105/105 [01:29<00:00,  1.76it/s]Transaction Queries: 100%|██████████| 105/105 [01:29<00:00,  1.17it/s]
INFO:llm_reranker:Loading matches from ./temp/jul-22_transaction_matches.csv
INFO:llm_reranker:Processing 315 match records...
INFO:llm_reranker:Grouping transactions by: ['t_ITEMCODE', 't_NEW_CODES', 't_STORECODE', 't_DATE']
|INFO| Saved transaction matches to ./temp/jul-22_transaction_matches.csv
|INFO| Running LLM re-ranking for jul-22
LLM Re-ranking:   0%|          | 0/105 [00:00<?, ?it/s]LLM Re-ranking:   1%|          | 1/105 [00:30<52:45, 30.43s/it]LLM Re-ranking:   2%|▏         | 2/105 [01:04<56:02, 32.64s/it]LLM Re-ranking:   3%|▎         | 3/105 [01:41<58:34, 34.45s/it]LLM Re-ranking:   4%|▍         | 4/105 [02:16<58:51, 34.96s/it]LLM Re-ranking:   5%|▍         | 5/105 [02:50<57:34, 34.55s/it]LLM Re-ranking:   6%|▌         | 6/105 [03:23<56:09, 34.03s/it]LLM Re-ranking:   7%|▋         | 7/105 [03:56<54:50, 33.58s/it]LLM Re-ranking:   8%|▊         | 8/105 [04:29<53:56, 33.36s/it]LLM Re-ranking:   9%|▊         | 9/105 [05:02<53:13, 33.27s/it]LLM Re-ranking:  10%|▉         | 10/105 [05:35<52:26, 33.12s/it]LLM Re-ranking:  10%|█         | 11/105 [06:07<51:41, 33.00s/it]LLM Re-ranking:  11%|█▏        | 12/105 [06:40<50:57, 32.87s/it]LLM Re-ranking:  12%|█▏        | 13/105 [07:12<50:11, 32.73s/it]LLM Re-ranking:  13%|█▎        | 14/105 [07:45<49:24, 32.58s/it]LLM Re-ranking:  14%|█▍        | 15/105 [08:16<48:27, 32.30s/it]LLM Re-ranking:  15%|█▌        | 16/105 [08:48<47:38, 32.11s/it]LLM Re-ranking:  16%|█▌        | 17/105 [09:20<46:50, 31.94s/it]LLM Re-ranking:  17%|█▋        | 18/105 [09:49<45:20, 31.26s/it]LLM Re-ranking:  18%|█▊        | 19/105 [10:20<44:44, 31.21s/it]LLM Re-ranking:  19%|█▉        | 20/105 [10:50<43:35, 30.77s/it]LLM Re-ranking:  20%|██        | 21/105 [11:22<43:25, 31.02s/it]LLM Re-ranking:  21%|██        | 22/105 [11:51<42:17, 30.57s/it]LLM Re-ranking:  22%|██▏       | 23/105 [12:23<42:08, 30.84s/it]LLM Re-ranking:  23%|██▎       | 24/105 [12:52<41:04, 30.42s/it]LLM Re-ranking:  24%|██▍       | 25/105 [13:22<40:12, 30.16s/it]LLM Re-ranking:  25%|██▍       | 26/105 [13:51<39:32, 30.04s/it]LLM Re-ranking:  26%|██▌       | 27/105 [14:19<38:06, 29.31s/it]LLM Re-ranking:  27%|██▋       | 28/105 [14:49<37:51, 29.50s/it]LLM Re-ranking:  28%|██▊       | 29/105 [15:16<36:36, 28.90s/it]LLM Re-ranking:  29%|██▊       | 30/105 [15:44<35:37, 28.50s/it]LLM Re-ranking:  30%|██▉       | 31/105 [16:12<34:53, 28.29s/it]LLM Re-ranking:  30%|███       | 32/105 [16:39<34:03, 28.00s/it]LLM Re-ranking:  31%|███▏      | 33/105 [17:07<33:29, 27.91s/it]LLM Re-ranking:  32%|███▏      | 34/105 [17:35<33:07, 27.99s/it]LLM Re-ranking:  33%|███▎      | 35/105 [18:02<32:20, 27.72s/it]LLM Re-ranking:  34%|███▍      | 36/105 [18:29<31:28, 27.37s/it]LLM Re-ranking:  35%|███▌      | 37/105 [18:55<30:31, 26.93s/it]LLM Re-ranking:  36%|███▌      | 38/105 [19:21<29:50, 26.72s/it]LLM Re-ranking:  37%|███▋      | 39/105 [19:47<29:07, 26.48s/it]LLM Re-ranking:  38%|███▊      | 40/105 [20:13<28:38, 26.44s/it]LLM Re-ranking:  39%|███▉      | 41/105 [20:38<27:42, 25.98s/it]LLM Re-ranking:  40%|████      | 42/105 [21:01<26:29, 25.24s/it]LLM Re-ranking:  41%|████      | 43/105 [21:26<25:46, 24.94s/it]LLM Re-ranking:  42%|████▏     | 44/105 [21:49<24:57, 24.55s/it]LLM Re-ranking:  43%|████▎     | 45/105 [22:14<24:35, 24.60s/it]LLM Re-ranking:  44%|████▍     | 46/105 [22:37<23:49, 24.24s/it]LLM Re-ranking:  45%|████▍     | 47/105 [23:02<23:30, 24.32s/it]LLM Re-ranking:  46%|████▌     | 48/105 [23:26<22:56, 24.15s/it]LLM Re-ranking:  47%|████▋     | 49/105 [23:50<22:35, 24.21s/it]LLM Re-ranking:  48%|████▊     | 50/105 [24:13<21:55, 23.92s/it]LLM Re-ranking:  49%|████▊     | 51/105 [24:36<21:13, 23.58s/it]LLM Re-ranking:  50%|████▉     | 52/105 [24:59<20:42, 23.44s/it]LLM Re-ranking:  50%|█████     | 53/105 [25:21<19:49, 22.87s/it]LLM Re-ranking:  51%|█████▏    | 54/105 [25:41<18:51, 22.19s/it]LLM Re-ranking:  52%|█████▏    | 55/105 [26:02<18:10, 21.80s/it]LLM Re-ranking:  53%|█████▎    | 56/105 [26:23<17:29, 21.41s/it]LLM Re-ranking:  54%|█████▍    | 57/105 [26:43<16:55, 21.16s/it]LLM Re-ranking:  55%|█████▌    | 58/105 [27:04<16:25, 20.97s/it]LLM Re-ranking:  56%|█████▌    | 59/105 [27:24<15:49, 20.64s/it]LLM Re-ranking:  57%|█████▋    | 60/105 [27:44<15:19, 20.44s/it]LLM Re-ranking:  58%|█████▊    | 61/105 [28:04<14:53, 20.32s/it]LLM Re-ranking:  59%|█████▉    | 62/105 [28:24<14:32, 20.28s/it]LLM Re-ranking:  60%|██████    | 63/105 [28:44<14:13, 20.32s/it]LLM Re-ranking:  61%|██████    | 64/105 [29:04<13:45, 20.14s/it]LLM Re-ranking:  62%|██████▏   | 65/105 [29:24<13:20, 20.00s/it]LLM Re-ranking:  63%|██████▎   | 66/105 [29:44<12:58, 19.96s/it]LLM Re-ranking:  64%|██████▍   | 67/105 [30:04<12:38, 19.95s/it]LLM Re-ranking:  65%|██████▍   | 68/105 [30:23<12:14, 19.86s/it]LLM Re-ranking:  66%|██████▌   | 69/105 [30:43<11:54, 19.85s/it]LLM Re-ranking:  67%|██████▋   | 70/105 [31:03<11:31, 19.77s/it]LLM Re-ranking:  68%|██████▊   | 71/105 [31:22<11:13, 19.81s/it]LLM Re-ranking:  69%|██████▊   | 72/105 [31:42<10:51, 19.74s/it]LLM Re-ranking:  70%|██████▉   | 73/105 [32:02<10:32, 19.76s/it]LLM Re-ranking:  70%|███████   | 74/105 [32:21<10:10, 19.70s/it]LLM Re-ranking:  71%|███████▏  | 75/105 [32:41<09:50, 19.69s/it]LLM Re-ranking:  72%|███████▏  | 76/105 [33:01<09:31, 19.71s/it]LLM Re-ranking:  73%|███████▎  | 77/105 [33:21<09:14, 19.80s/it]LLM Re-ranking:  74%|███████▍  | 78/105 [33:41<08:53, 19.76s/it]LLM Re-ranking:  75%|███████▌  | 79/105 [34:00<08:32, 19.72s/it]LLM Re-ranking:  76%|███████▌  | 80/105 [34:20<08:15, 19.83s/it]LLM Re-ranking:  77%|███████▋  | 81/105 [34:39<07:47, 19.48s/it]LLM Re-ranking:  78%|███████▊  | 82/105 [34:58<07:24, 19.32s/it]LLM Re-ranking:  79%|███████▉  | 83/105 [35:17<07:03, 19.23s/it]LLM Re-ranking:  80%|████████  | 84/105 [35:36<06:44, 19.28s/it]LLM Re-ranking:  81%|████████  | 85/105 [35:55<06:23, 19.18s/it]LLM Re-ranking:  82%|████████▏ | 86/105 [36:14<06:01, 19.02s/it]LLM Re-ranking:  83%|████████▎ | 87/105 [36:32<05:39, 18.89s/it]LLM Re-ranking:  84%|████████▍ | 88/105 [36:51<05:19, 18.78s/it]LLM Re-ranking:  85%|████████▍ | 89/105 [37:10<04:59, 18.75s/it]LLM Re-ranking:  86%|████████▌ | 90/105 [37:28<04:40, 18.73s/it]LLM Re-ranking:  87%|████████▋ | 91/105 [37:47<04:21, 18.71s/it]LLM Re-ranking:  88%|████████▊ | 92/105 [38:06<04:03, 18.75s/it]LLM Re-ranking:  89%|████████▊ | 93/105 [38:24<03:41, 18.46s/it]LLM Re-ranking:  90%|████████▉ | 94/105 [38:41<03:19, 18.17s/it]LLM Re-ranking:  90%|█████████ | 95/105 [38:58<02:56, 17.70s/it]LLM Re-ranking:  91%|█████████▏| 96/105 [39:13<02:32, 16.99s/it]LLM Re-ranking:  92%|█████████▏| 97/105 [39:29<02:13, 16.64s/it]LLM Re-ranking:  93%|█████████▎| 98/105 [39:44<01:54, 16.29s/it]LLM Re-ranking:  94%|█████████▍| 99/105 [40:00<01:36, 16.08s/it]LLM Re-ranking:  95%|█████████▌| 100/105 [40:16<01:19, 15.96s/it]LLM Re-ranking:  96%|█████████▌| 101/105 [40:31<01:03, 15.89s/it]LLM Re-ranking:  97%|█████████▋| 102/105 [40:47<00:47, 15.82s/it]LLM Re-ranking:  97%|█████████▋| 102/105 [40:47<01:11, 23.99s/it]
INFO:llm_reranker:Saved LLM re-ranked results to ./temp/jul-22_llm_reranked.csv
INFO:llm_reranker:
==================================================
INFO:llm_reranker:LLM RE-RANKING SUMMARY
INFO:llm_reranker:==================================================
INFO:llm_reranker:Total transactions processed: 102
INFO:llm_reranker:Successfully re-ranked: 76 (74.5%)
INFO:llm_reranker:Rejected (no good match): 26 (25.5%)
INFO:llm_reranker:LLM query failures: 0 (0.0%)
INFO:llm_reranker:==================================================
|INFO| LLM re-ranking completed. Results saved to ./temp/jul-22_llm_reranked.csv
|INFO| Completed processing jul-22
